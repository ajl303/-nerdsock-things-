{"_id":"5t6gzHSjmR5Z0gyA","name":"Faerie Fire","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/faerie-fire.webp","scope":"global","command":"game.macros.getName(\"FaerieFireSequence\").execute();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.fkWwonwubzefdFFE"}}}
{"name":"Searing Light","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/searing-light.webp","scope":"global","command":"//macro that makes a spell attack roll compared to the\n///target's AC, and plays the appropriate Searing Light\n////sequence macro: missing if miss and hitting if hit\n\n//this version implements a checker for the Shadow Signet item to allow targeting of other defensive statistics.\n\n//get all the relevant data from the target and the caster\nmain()\n\nasync function main(){\n\t//get target and caster, give error if no target or there is not exactly one selected token\n\tlet target = game.user.targets.values().next().value;\n\tif(target == undefined || target == null){\n\t\tui.notifications.error(\"Please select a target.\");\n\t\tgame.macros.getName(\"Lagomorph\").execute();\n\t\treturn;\n\t}\n\tif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\t\tui.notifications.error(\"Please select exactly one token.\");\n\t\tgame.macros.getName(\"Lagomorph\").execute();\n\t\treturn;\n\t}\n\tlet caster = game.canvas.tokens.controlled[0];\n\t//pull relevant values from caster and target to derive spell attack roll modifier and\n\t///target AC\n\tlet targetAC = target.actor.data.data.attributes.ac.value;\n\tif(caster.actor.data.data.custom.modifiers.shadowSignet == 1){\n\t\ttargetAC = await checkSignet(target.actor);\n\t}\n\tconsole.log(\"targetAC:\",targetAC);\n\tlet toHitMod = 0;\n\tlet tempIt = caster.actor.spellcasting.values();\n\tconsole.log(\"tempIt:\", tempIt);\n\ttempIt.next();\n\tlet castStat = tempIt.next().value.data.data.ability.value;\n\tconsole.log(\"castStat:\", castStat);\n\t//switch statement to apply relevant casting stat\n\tswitch(castStat){\n\t\tcase \"int\":\n\t\t\ttoHitMod = toHitMod + caster.actor.data.data.abilities.int.mod;\n\t\t\tbreak;\n\t\tcase \"wis\":\n\t\t\ttoHitMod = toHitMod + caster.actor.data.data.abilities.wis.mod\n\t\t\tbreak;\n\t\tcase \"cha\":\n\t\t\ttoHitMod = toHitMod + caster.actor.data.data.abilities.cha.mod\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tui.notifications.error(\"Unrecognized casting modifier.\");\n\t\t\treturn;\n\t}\n\ttoHitMod = toHitMod + caster.actor.data.data.details.level.value + (2*caster.actor.data.data.proficiencies.traditions.divine.rank);\n\tconsole.log(\"toHitMod:\", toHitMod);\n\n\t//construct the roll object and determine if it hits or misses. Boolean to check for true strike.\n\tlet roll = undefined;\n\tlet rollFlavor = \"Searing Light\";\n\tif(caster.actor.data.data.custom.modifiers.trueStrike == 1){\n\t\troll = new Roll('2d20kh+' + parseInt(toHitMod));\n\t\trollFlavor = rollFlavor + \" (True Strike)\";\n\t\t//find and delete true strike effect\n\t\tlet effectArray = caster.actor.data.items.contents;\n\t\tfor(let i = 0; i < effectArray.length; i++){\n\t\t\tif(effectArray[i].data.name.includes(\"Effect: True Strike\")){\n\t\t\t\teffectArray[i].delete();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t} else {\n\t\troll = new Roll('1d20+' + parseInt(toHitMod));\n\t}\n\tawait roll.evaluate();\n\tconsole.log(\"result:\", roll.result);\n\tawait hitOrMiss(parseInt(roll.result)+toHitMod, targetAC, roll);\n\tawait roll.toMessage({ flavor: rollFlavor, speaker: ChatMessage.getSpeaker({actor: actor})});\n\t//activate the Conducting rune\n\t//game.macros.getName(\"Conductive (Fire)\").execute();\n}\n\nasync function hitOrMiss(hit,ac,dice){\n\tresult = parseInt(dice.result);\n\tif(result == 20){\n\t\thit = hit + 10;\n\t} else if(result == 1){\n\t\thit = hit - 10;\n\t}\n\tif(hit >= ac + 10){\n\t\t//critical hit\n\t\tconsole.log(\"Crit!!\");\n\t\tawait game.macros.getName(\"SearingLightSequenceCrit\").execute();\n\t} else if(hit >= ac){\n\t\t//hit\n\t\tconsole.log(\"Hit!\");\n\t\tawait game.macros.getName(\"SearingLightSequence\").execute();\n\t} else if(hit > ac - 10){\n\t\t//miss\n\t\tconsole.log(\"Miss.\");\n\t\tawait game.macros.getName(\"SearingLightSequenceMiss\").execute();\n\t} else {\n\t\t//critical miss\n\t\tconsole.log(\"Crit Miss\");\n\t\tawait game.macros.getName(\"SearingLightSequenceCritMiss\").execute();\n\t}\n}\n\nasync function damage(level){\n\t//figure out the d6 situation\n\tlet dice = 2*(level-3) + 5;\n\tconsole.log(dice);\n\tdice = dice + \"d6\";\n\tlet fireRoll = new Roll(dice);\n\tlet confirmation = await Dialog.confirm({\n\t\ttitle: 'Fiend/Undead or Not?',\n\t\tcontent: `<p>Is your target a fiend or an undead?</p>`,\n\t});\n\tawait fireRoll.roll();\n\tfireRoll.toMessage({ flavor: \"Fire Damage\", speaker: ChatMessage.getSpeaker({actor: actor})});\n\tif(confirmation){\n\t\tlet goodRoll = new Roll(dice);\n\t\tawait goodRoll.roll();\n\t\t//output\n\t\tgoodRoll.toMessage({ flavor: \"Good Damage\", speaker: ChatMessage.getSpeaker({actor: actor})});\n\t}\n}\n\nasync function checkSignet(foe){\n\tlet confirmation = await Dialog.confirm({\n\t\ttitle: 'Shadow Signet',\n\t\tcontent: `<p>Will you be using your Shadow Signet?</p>`,\n\t});\n\tif(!confirmation){\n\t\tconsole.log(\"AC\", foe.data.data.attributes.ac.value);\n\t\treturn foe.data.data.attributes.ac.value;\n\t}\n\tlet returner = undefined;\n\tlet promise = new Promise(function(resolve, reject){\n\t\tlet choose = new Dialog({\n\t\t\ttitle: 'Shadow Signet',\n\t\t\tcontent: `Will you target Fortitude DC, or Reflex DC?`,\n\t\t\tbuttons: {\n\t\t\t\tfortitude: {\n\t\t\t\t\ticon: '<i class=\"fas fa-heartbeat\"></i>',\n\t\t\t\t\tlabel: 'Fortitude DC',\n\t\t\t\t\t//callback: () => console.log(\"Chose Fortitude\")\n\t\t\t\t\tcallback: () => resolve(foe.data.data.saves.fortitude.totalModifier + 10)\n\t\t\t\t},\n\t\t\t\treflex: {\n\t\t\t\t\ticon: '<i class=\"fas fa-running\"></i>',\n\t\t\t\t\tlabel: 'Reflex DC',\n\t\t\t\t\t//callback: () => console.log(\"Chose Reflex\")\n\t\t\t\t\tcallback: () => resolve(foe.data.data.saves.reflex.totalModifier + 10)\n\t\t\t\t}\n\t\t\t}\n\t\t}).render(true);\n\t});\n\treturn promise;\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.s7DOhpZfbbAumI6F"}},"_id":"6jin1xMnOVKXQN4y"}
{"_id":"8oo3zsssCHyXjSo3","name":"True Strike","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/true-strike.webp","scope":"global","command":"//plays an FF6 esque casting animation on the selected token,\n//and plays a twinkle in the eye of the selected token.\n//eye position will have to be tweaked to the individual token.\nif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\tui.notifications.error(\"Please select exactly one token.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\n//let centerer = game.canvas.grid.size/2;\nlet caster = game.canvas.tokens.controlled[0];\n//let cx = caster.data.x + (centerer * caster.data.width);\n//let cy = caster.data.y + (centerer * caster.data.height);\nlet cx = caster.data.x + 57;\nlet cy = caster.data.y + 73;\nnew Sequence()\n\n\t.sound(\"SFX/FF6SFx/00BlueMagic.wav\")\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t//.startTimePerc(0.5)\n\t\t.timeRange(100,1700)\n\t\t.scale(0.5* caster.data.width)\n\t\t.fadeIn(350)\n\t\t.fadeOut(500)\n\t\t//.file(\"modules/animated-spell-effects/spell-effects/energy/energy_explosion_02.webm\")\n\t\t.file(\"modules/JB2A_DnD5e/Library/Generic/Energy/SwirlingSparkles_01_Regular_Blue_400x400.webm\")\n\t\t.waitUntilFinished()\n\t.wait(500)\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t//.file(\"modules/JB2A_DnD5e/Library/1st_Level/Cure_Wounds/CureWounds_01_Blue_200x200.webm\")\n    \t.file(\"modules/JB2A_DnD5e/Library/Generic/Twinkling_Stars/TwinklingStars_04_Orange_100x100.webm\")\n\t\t.scale(0.3* caster.data.width)\n\t\t.timeRange(1000,2000)\n\t\t.fadeIn(500)\n\t\t.fadeOut(500)\n\t.sound(\"SFX/FF6SFx/C6SAVETING.wav\")\n\t//.sound(\"SFX/FF6SFx/8bSaveTing.wav\")\n\t.play();\nlet tsEffect = await fromUuid('Item.xSi2oGV6D7k5i0kI');\ntsEffect = [duplicate(tsEffect)];\nawait caster.actor.createEmbeddedDocuments('Item',tsEffect);","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.UTjD6EmDflxwrn5T"}}}
{"_id":"A017IFsftoHUInf7","name":"Inner Radiance Torrent","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/inner-radiance-torrent.webp","scope":"global","command":"/*ask player if they're casting the spell now,\n charging up, or completing a charged\n spell. Also get the level of the spell*/\nmain();\n\nasync function main(){\n\t//let isSmol = true;\n\tlet irtDialog = new Dialog({\n\t\ttitle: 'Inner Radiance Torrent',\n\t\tcontent: `\n\t\t\t<center>Please enter the spell level and select the number of rounds.</center>\n\t\t\t\t<form class=\"flexcol\">\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"level\">Spell Level:</label>\n\t\t\t\t\t\t<input type=\"number\" name=\"level\">\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t`,\n\t\tbuttons: {\n\t\t\tone: {\n\t\t\t\tlabel: 'One Round',\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tdamage(true,html.find('[name=\"level\"]').val());\n\t\t\t\t}\n\t\t\t},\n\t\t\ttwo: {\n\t\t\t\tlabel: 'Two Rounds (Charging)',\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tgame.macros.getName(\"IRTSequenceCharge\").execute();\n\t\t\t\t}\n\t\t\t},\n\t\t\tthree: {\n\t\t\t\tlabel: 'Two Rounds (Casting)',\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tdamage(false,html.find('[name=\"level\"]').val());\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t}).render(true);\n}\n\nasync function damage(smol,level){\n\tlevel = level - 1;\n\tif(smol){\n\t\tgame.macros.getName(\"IRTSequenceShort\").execute();\n\t} else {\n\t\tlevel = level * 2;\n\t\tgame.macros.getName(\"IRTSequenceLong\").execute();\n\t}\n\tlet roll = new Roll(parseInt(4*level)+\"d4\");\n\troll.roll;\n\toutput(roll);\n}\n\nasync function output(roll){\n\troll.toMessage({ flavor: \"Inner Radiance Torrent\",speaker: ChatMessage.getSpeaker({actor: actor})});\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.8eBfCcd5EedPB33f"},"advanced-macros":{"runAsGM":false}}}
{"_id":"Bc54k3nZa0U5wGC8","name":"Dazzling Flash","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/dazzling-flash.webp","scope":"global","command":"game.macros.getName(\"DazzlingFlashSequence\").execute();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.qeROG4KAeYA1Xt2j"}}}
{"name":"ApplyDiviner'sSight","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/diviners-sight.webp","scope":"global","command":"let modifier = await Dialog.prompt({\n  content: `Result of the d20?<input type=\"number\">`,\n  callback: (html) => html.find('input').val() \n})\nlet mod2 = await Dialog.prompt({\n\tcontent: `Modifier of the skill or save?<input type=\"number\">`,\n\tcallback: (html) => html.find('input').val()\n})\nmod2 = parseInt(mod2);\nrollyboi  = \"1d20max\"+modifier+\"min\"+modifier+\"+\";\n//console.log(rollyboi);\nconst roll = new Roll(rollyboi + parseInt(mod2));\n\nroll.roll();\n\nroll.toMessage({ flavor: \"The future holds:\", speaker: ChatMessage.getSpeaker({actor: actor})});","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.R3AuIJr84QIngAjh"}},"_id":"CjZ99gUM3b27wypb"}
{"_id":"OdUTEGGT0jzIzfj9","name":"Fear","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/fear.webp","scope":"global","command":"game.macros.getName(\"FearSequence\").execute();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.jhMGijglViQylDiY"}}}
{"name":"Fire Ray","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/fire-ray.webp","scope":"global","command":"//macro that makes a spell attack roll compared to the\n///target's AC, and plays the appropriate FireRay\n////sequence macro: missing if miss and hitting if hit\n\n//this version implements a checker for the Shadow Signet item to allow targeting of other defensive statistics.\n\n//get all the relevant data from the target and the caster\nmain()\n\nasync function main(){\n\t//get target and caster, give error if no target or there is not exactly one selected token\n\tlet target = game.user.targets.values().next().value;\n\tif(target == undefined || target == null){\n\t\tui.notifications.error(\"Please select a target.\");\n\t\tgame.macros.getName(\"Lagomorph\").execute();\n\t\treturn;\n\t}\n\tif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\t\tui.notifications.error(\"Please select exactly one token.\");\n\t\tgame.macros.getName(\"Lagomorph\").execute();\n\t\treturn;\n\t}\n\tlet caster = game.canvas.tokens.controlled[0];\n\t//pull relevant values from caster and target to derive spell attack roll modifier and\n\t///target AC\n\tlet targetAC = target.actor.data.data.attributes.ac.value;\n\tif(caster.actor.data.data.custom.modifiers.shadowSignet == 1){\n\t\ttargetAC = await checkSignet(target.actor);\n\t}\n\tconsole.log(\"targetAC:\",targetAC);\n\tlet toHitMod = 0;\n\tlet tempIt = caster.actor.spellcasting.values();\n\tconsole.log(\"tempIt:\", tempIt);\n\ttempIt.next();\n\tlet castStat = tempIt.next().value.data.data.ability.value;\n\tconsole.log(\"castStat:\", castStat);\n\t//switch statement to apply relevant casting stat\n\tswitch(castStat){\n\t\tcase \"int\":\n\t\t\ttoHitMod = toHitMod + caster.actor.data.data.abilities.int.mod;\n\t\t\tbreak;\n\t\tcase \"wis\":\n\t\t\ttoHitMod = toHitMod + caster.actor.data.data.abilities.wis.mod\n\t\t\tbreak;\n\t\tcase \"cha\":\n\t\t\ttoHitMod = toHitMod + caster.actor.data.data.abilities.cha.mod\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tui.notifications.error(\"Unrecognized casting modifier.\");\n\t\t\treturn;\n\t}\n\ttoHitMod = toHitMod + caster.actor.data.data.details.level.value + (2*caster.actor.data.data.proficiencies.traditions.divine.rank);\n\tconsole.log(\"toHitMod:\", toHitMod);\n\n\t//construct the roll object and determine if it hits or misses. Boolean to check for true strike.\n\tlet roll = undefined;\n\tlet rollFlavor = \"Fire Ray\";\n\tif(caster.actor.data.data.custom.modifiers.trueStrike == 1){\n\t\troll = new Roll('2d20kh+' + parseInt(toHitMod));\n\t\trollFlavor = rollFlavor + \" (True Strike)\";\n\t\t//find and delete true strike effect\n\t\tlet effectArray = caster.actor.data.items.contents;\n\t\tfor(let i = 0; i < effectArray.length; i++){\n\t\t\tif(effectArray[i].data.name.includes(\"Effect: True Strike\")){\n\t\t\t\teffectArray[i].delete();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t} else {\n\t\troll = new Roll('1d20+' + parseInt(toHitMod));\n\t}\n\tawait roll.evaluate();\n\tconsole.log(\"result:\", roll.result);\n\tawait hitOrMiss(parseInt(roll.result)+toHitMod, targetAC, roll);\n\tawait roll.toMessage({ flavor: rollFlavor, speaker: ChatMessage.getSpeaker({actor: actor})});\n\tdamage(caster.actor);\n\t//activate the Conducting rune\n\t//game.macros.getName(\"Conductive (Fire)\").execute();\n\t//game.macros.getName(\"AdvanceCurse\").execute();\n}\n\nasync function hitOrMiss(hit,ac,dice){\n\tresult = parseInt(dice.result);\n\tif(result == 20){\n\t\thit = hit + 10;\n\t} else if(result == 1){\n\t\thit = hit - 10;\n\t}\n\tif(hit >= ac + 10){\n\t\t//critical hit\n\t\tconsole.log(\"Crit!!\");\n\t\tawait game.macros.getName(\"FireRaySequenceCrit\").execute();\n\t} else if(hit >= ac){\n\t\t//hit\n\t\tconsole.log(\"Hit!\");\n\t\tawait game.macros.getName(\"FireRaySequence\").execute();\n\t} else if(hit > ac - 10){\n\t\t//miss\n\t\tconsole.log(\"Miss.\");\n\t\tawait game.macros.getName(\"FireRaySequenceMiss\").execute();\n\t} else {\n\t\t//critical miss\n\t\tconsole.log(\"Crit Miss\");\n\t\tawait game.macros.getName(\"FireRaySequenceCritMiss\").execute();\n\t}\n}\n\nasync function damage(caster){\n\tlet dice = 2 * Math.ceil(caster.data.data.details.level.value/2);\n\tlet roll = new Roll(dice + \"d6\");\n\tawait roll.roll();\n\troll.toMessage({ flavor: \"Fire Ray Damage\", speaker: ChatMessage.getSpeaker({actor: actor})});\n}\n\nasync function checkSignet(foe){\n\tlet confirmation = await Dialog.confirm({\n\t\ttitle: 'Shadow Signet',\n\t\tcontent: `<p>Will you be using your Shadow Signet?</p>`,\n\t});\n\tif(!confirmation){\n\t\tconsole.log(\"AC\", foe.data.data.attributes.ac.value);\n\t\treturn foe.data.data.attributes.ac.value;\n\t}\n\tlet returner = undefined;\n\tlet promise = new Promise(function(resolve, reject){\n\t\tlet choose = new Dialog({\n\t\t\ttitle: 'Shadow Signet',\n\t\t\tcontent: `Will you target Fortitude DC, or Reflex DC?`,\n\t\t\tbuttons: {\n\t\t\t\tfortitude: {\n\t\t\t\t\ticon: '<i class=\"fas fa-heartbeat\"></i>',\n\t\t\t\t\tlabel: 'Fortitude DC',\n\t\t\t\t\t//callback: () => console.log(\"Chose Fortitude\")\n\t\t\t\t\tcallback: () => resolve(foe.data.data.saves.fortitude.totalModifier + 10)\n\t\t\t\t},\n\t\t\t\treflex: {\n\t\t\t\t\ticon: '<i class=\"fas fa-running\"></i>',\n\t\t\t\t\tlabel: 'Reflex DC',\n\t\t\t\t\t//callback: () => console.log(\"Chose Reflex\")\n\t\t\t\t\tcallback: () => resolve(foe.data.data.saves.reflex.totalModifier + 10)\n\t\t\t\t}\n\t\t\t}\n\t\t}).render(true);\n\t});\n\treturn promise;\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.C7t44VeFuqVipHBH"}},"_id":"PauYRAFasEQTux9U"}
{"_id":"RKqKtOWV8BWlmRxZ","name":"Diviner's Sight","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/diviners-sight.webp","scope":"global","command":"game.macros.getName(\"DivinerSightSequence\").execute();\ngame.macros.getName(\"GetDivSight\").execute();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.bvqmgHth6haTBMT5"}}}
{"_id":"X5PDnNdOPK6gqzTC","name":"Vision of Weakness","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/vision-of-weakness.webp","scope":"global","command":"/*searches through target's Weaknesses and displays them, \nif applicable. Additionally, calculates lowest saving throw\nand displays that as well.\n*/\n\nlet target = game.user.targets.values().next().value;\nif(target == undefined || target == null){\n\tui.notifications.error(\"Please select a target.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\nif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\tui.notifications.error(\"Please select exactly one token.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\n\n/*get target's saving throws, and whatever string holds\nweaknesses*/\nlet fort = target.actor.data.data.saves.fortitude.value;\nlet reflex = target.actor.data.data.saves.reflex.value;\nlet will = target.actor.data.data.saves.will.value;\nlet lowest = \"\";\n\n//compare saving throws against each other, display lowest one.\nif(fort < reflex && fort < will){\n\tlowest = \"Fortitude.\";\n} else if(reflex < fort && reflex < will){\n\tlowest = \"Reflex.\";\n} else if(will < fort && will < reflex){\n\tlowest = \"Will.\";\n} else if(fort == reflex && fort < will){\n\tlowest = \"Fortitude and Reflex (tie).\";\n} else if(reflex == will && reflex <  fort){\n\tlowest = \"Reflex and Will (tie).\";\n} else if(fort == will && fort < reflex){\n\tlowest = \"Fortitude and Will (tie).\";\n} else {\n\tlowest = \"I'm confused. Ask the GM.\";\n}\n\nlet weakness = \"\";\n//look for weaknesses, if none weakness = \"The target has no weaknesses.\n\nChatMessage.create({\n\tuser: game.user._id,\n\tspeaker: ChatMessage.getSpeaker({token: actor, alias:\"Vision of Weakness\"}),\n\tcontent: `The target's lowest save is: ${lowest}`\n});\n\ngame.macros.getName(\"VisionOfWeaknessSequence\").execute();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.LNlZ1VpdUooKttMr"}}}
{"_id":"dYmUwChteNIZaWHd","name":"Heal","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/heal.webp","scope":"global","command":"//This variable will be the default spell level\n//if you do not enter one yourself.\nlet defaultLevel = 0;\n\nmain();\n\nasync function main(){\n\tlet spellLevel = 0;\n\t//get spell level and action amount from user input\n\tlet actionDialog = new Dialog({\n\t\ttitle: 'Heal',\n\t\tcontent: `\n\t\t\t<center>Please enter the spell level and select the number of actions.</center>\n\t\t\t<form class=\"flexcol\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"level\">Spell Level:</label>\n\t\t\t\t\t<input type=\"number\" name=\"level\">\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t`,\n\t\tbuttons: {\n\t\t\tone: {\n\t\t\t\t//label: 'One Action',\n\t\t\t\ticon: `<span class='pf2-icon'>1</span>`,\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tspellLevel = html.find('[name=\"level\"]').val();\n\t\t\t\t\thealingRoll(1,spellLevel);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttwo: {\n\t\t\t\t//label: 'Two Actions',\n\t\t\t\ticon: `<span class='pf2-icon'>2</span>`,\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tspellLevel = html.find('[name=\"level\"]').val();\n\t\t\t\t\thealingRoll(2,spellLevel);\n\t\t\t\t}\n\t\t\t},\n\t\t\tthree: {\n\t\t\t\t//label: 'Three Actions',\n\t\t\t\ticon: `<span class='pf2-icon'>3</span>`,\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tspellLevel = html.find('[name=\"level\"]').val();\n\t\t\t\t\thealingRoll(3,spellLevel);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t}).render(true);\n}\n\nasync function healingRoll(actions,spellLevel){\n\tlet roll = undefined;\n\tif(actions == 1){\n\t\tgame.macros.getName(\"HealSequence\").execute();\n\t\troll = new Roll(parseInt(spellLevel)+\"d8\");\n\t} else if(actions == 2){\n\t\tgame.macros.getName(\"HealSequence\").execute();\n\t\troll = new Roll(parseInt(spellLevel)+\"d8+\"+parseInt(spellLevel*8));\n\t} else if(actions == 3){\n\t\tgame.macros.getName(\"HealSequence3A\").execute();\n\t\troll = new Roll(parseInt(spellLevel)+\"d8\");\n\t} else {\n\t\tui.notifications.error(\"Nonstandard number of actions.\");\n\t\treturn;\n\t}\n\tawait roll.roll();\n\tlet label = \"Heal (\"+actions+\"a)\";\n\troll.toMessage({ flavor: label, speaker: ChatMessage.getSpeaker({actor: actor})});\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.cublmInGjTGAgES9"},"advanced-macros":{"runAsGM":false}}}
{"_id":"f7GKPKTfZj1QQ63q","name":"Jump","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/jump.webp","scope":"global","command":"//plays an FF6 esque casting animation on the selected token,\n//and jumps the token to a targetting aid.\n//if the target is the Target Helper, deletes the helper.\nlet target = game.user.targets.values().next().value;\nif(target == undefined || target == null){\n\tui.notifications.error(\"Please select a target.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\nlet caster = game.canvas.tokens.controlled[0];\nif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\tui.notifications.error(\"Please select exactly one token.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\nlet centerer = game.canvas.grid.size/2;\nlet cx = caster.data.x + (centerer * caster.data.width);\nlet cy = caster.data.y + (centerer * caster.data.height);\nlet tx = target.data.x;\nlet ty = target.data.y;\nif(target.data.name.includes(\"Target Helper\")){\n\ttarget.delete();\n}\nnew Sequence()\n\n\t.sound(\"SFX/FF6SFx/00BlueMagic.wav\")\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t//.startTimePerc(0.5)\n\t\t.timeRange(100,1700)\n\t\t.scale(0.5)\n\t\t.fadeIn(350)\n\t\t.fadeOut(500)\n\t\t//.file(\"modules/animated-spell-effects/spell-effects/energy/energy_explosion_02.webm\")\n\t\t.file(\"modules/JB2A_DnD5e/Library/Generic/Energy/SwirlingSparkles_01_Regular_Blue_400x400.webm\")\n\t\t.waitUntilFinished()\n\t.wait(200)\n\t.animation()\n\t\t.on(caster)\n\t\t.moveTowards({x: tx, y: ty}, {ease: \"easeInBack\"})\n\t.sound(\"SFX/FF6SFx/6AJumpDragonboots.wav\")\n\t.play();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.QJuLHr0LsA0EV3WO"}}}
{"_id":"kEY8zcqkjORpwfnm","name":"Time Jump","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/time-jump.webp","scope":"global","command":"//plays an FF6 esque casting animation on the selected token,\n//and teleports the token to a targetting aid.\n//if the target is the Target Helper, deletes the helper.\nlet target = game.user.targets.values().next().value;\nif(target == undefined || target == null){\n\tui.notifications.error(\"Please select a target.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\nlet caster = game.canvas.tokens.controlled[0];\nif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\tui.notifications.error(\"Please select exactly one token.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\nlet centerer = game.canvas.grid.size/2;\nlet cx = caster.data.x + (centerer * caster.data.width);\nlet cy = caster.data.y + (centerer * caster.data.height);\nlet tx = target.data.x;\nlet ty = target.data.y;\nif(target.data.name.includes(\"Target Helper\")){\n\ttarget.delete();\n}\nnew Sequence()\n\n\t.sound(\"SFX/FF6SFx/00BlueMagic.wav\")\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t//.startTimePerc(0.5)\n\t\t.timeRange(100,1700)\n\t\t.scale(0.5)\n\t\t.fadeIn(350)\n\t\t.fadeOut(500)\n\t\t//.file(\"modules/animated-spell-effects/spell-effects/energy/energy_explosion_02.webm\")\n\t\t.file(\"modules/JB2A_DnD5e/Library/Generic/Energy/SwirlingSparkles_01_Regular_Blue_400x400.webm\")\n\t\t.waitUntilFinished()\n\t.wait(200)\n\t.sound(\"SFX/DOTA 2/Chronosphere.mp3\")\n\t\t.volume(0.3)\n\t.effect()\n\t\t//greeblies for token vanishing\n\t\t.atLocation({x: cx, y: cy})\n\t\t.scale(0.5)\n\t\t.file(\"modules/animated-spell-effects/spell-effects/energy/flash_CIRCLE_01.webm\")\n\t.effect()\n\t\t//greeblies for token arriving\n\t\t.atLocation({x: tx + (centerer * target.data.width), y: ty + (centerer * target.data.height)})\n\t\t.scale(0.5)\n\t\t.file(\"modules/animated-spell-effects/spell-effects/energy/flash_CIRCLE_01.webm\")\n\t.wait(200)\n\t.animation()\n\t\t.on(caster)\n\t\t.teleportTo({x: tx, y: ty})\n\t.play();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.cUtmjGn7FbtXDYAr"}}}
{"_id":"kIL1OHo45AUxuurW","name":"Bless","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/bless.webp","scope":"global","command":"game.macros.getName(\"BlessSequence\").execute();\n//figure out how to use Active Auras or something to\n//auto give things in bless's aura the +1","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.KZy0Ph08R5EK2CZC"}}}
{"_id":"nV3JQb8aplKS2dy0","name":"Incendiary Aura","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/incendiary-aura.webp","scope":"global","command":"//documentation\nif(game.canvas.tokens.controlled.length > 1 || game.canvas.tokens.controlled.length < 1){\n\tui.notifications.error(\"Please select exactly one token.\");\n\tgame.macros.getName(\"Lagomorph\").execute();\n\treturn;\n}\nlet centerer = game.canvas.grid.size/2;\nlet caster = game.canvas.tokens.controlled[0];\nlet cx = caster.data.x + (centerer * caster.data.width);\nlet cy = caster.data.y + (centerer * caster.data.height);\nnew Sequence()\n\n\t.sound(\"SFX/FF6SFx/01BlackMagic.wav\")\n\t\t.volume(0.5)\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t.timeRange(1000,2500)\n\t\t.scale(0.3)\n\t\t.fadeIn(350)\n\t\t.fadeOut(500)\n\t\t.file(\"modules/animated-spell-effects/spell-effects/magic/magic_shockwave_CIRCLE_12.webm\")\n\t\t.waitUntilFinished()\n\t//.sound(\"SFX/FF6SFx/4EDeathSpell.wav\")\n\t\t//.volume(0.4)\n\t.sound(\"SFX/DOTA 2/Scorched_Earth_Cast.mp3\")\n\t\t.volume(0.2)\n\t\t.timeRange(0, 3500)\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t.file(\"modules/animated-spell-effects/spell-effects/fire/explosion_CIRCLE_01.webm\")\n\t\t.timeRange(0,2000)\n\t\t.fadeIn(100)\n\t\t.fadeOut(1000)\n\t\t.scale(3)\n\t\t.randomRotation()\n\t\t.waitUntilFinished(-1500)\n\t.effect()\n\t\t.atLocation({x: cx, y: cy})\n\t\t.file(\"modules/animated-spell-effects/spell-effects/fire/fire_circle_CIRCLE_04.webm\")\n\t\t.opacity(0.5)\n\t\t.scale(2)\n\t\t.timeRange(1000,3000)\n\t\t.fadeIn(500)\n\t\t.fadeOut(500)\n\t\n\t.play();","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.bWsQcUnT4H6LEeaY"}}}
{"_id":"o8Vz4gfZyBwd30JN","name":"Fireball","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/fireball.webp","scope":"global","command":"main()\n\nasync function main(){\n\tlet roll = undefined;\n\tlet spellLevel = await Dialog.prompt({\n\t  content: `Spell level?<input type=\"number\">`,\n\t  callback: (html) => html.find('input').val() \n\t});\n\tconsole.log(\"spellLevel:\",spellLevel);\n\tspellLevel = 2 * parseInt(spellLevel);\n\tconsole.log(\"spellLevel:\",spellLevel);\n\t//resolve(parseInt(spellLevel));\n\tlet testPromise = new Promise(function(resolve,reject){\n\t\troll = new Roll(spellLevel + \"d6\");\n\t\tresolve(roll.roll());\n\t}).then(function value(theRoll){\n\t\ttheRoll.toMessage({ flavor: \"Fireball Damage\", speaker: ChatMessage.getSpeaker({actor: actor})});\n\t\treturn;\n\t}).then(function value(){\n\t\tgame.macros.getName(\"FireballSequence\").execute();\n\t});\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.t3cbs4wLBesOu9cb"}}}
{"name":"VitalBeaconInitializer","type":"script","author":"gN2IS1aOvb93eNAA","img":"Icons/vitalbeacon10.webp","scope":"global","command":"main()\n\nasync function main(){\n\t//query user for spell level\n\tlet spellLevel = await Dialog.prompt({\n\t  content: `Good Morning! What level is Vital Beacon today?<input type=\"number\">`,\n\t  callback: (html) => html.find('input').val() \n\t})\n\t//ensure exactly one token is selected, then get that token's actor\n\tif(canvas.tokens.controlled.length == 0 || canvas.tokens.controlled.length > 1){\n\t\tui.notifications.error(\"Please select exactly one token.\");\n\t\treturn;\n\t}\n\tlet actor = canvas.tokens.controlled[0].actor;\n\t/*find old vital beacon effect in preparation to remove\n\t  it at the end of the macro*/\n\tlet depleated = actor.data.items.find(item => item.data.name.includes(\"Vital Beacon (d\"));\n\tconsole.log(depleated);\n\t/*locates the level selector effect to prepare to\n\t  update its level.*/\n\tlet levelEffect = actor.data.items.find(item => item.data.name == \"Vital Beacon (Level Selector)\");\n\t/*initializes a d10 vital beacon effect. Has to be\n\t   in an array to work with createEmbeddedDocuments*/\n\tlet startVit = await fromUuid('Item.K81NsRM2CeHUJE8L');\n\tstartVit = [duplicate(startVit)];\n\tawait actor.createEmbeddedDocuments('Item',startVit);\n\tawait levelEffect.update({\"data.level.value\": spellLevel});\n\tif(depleated != undefined && depleated != null){\n\t\tdepleated.delete();\n\t}\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.ZDT6HoNqsp2aBER0"}},"_id":"pb5sUy7YysEZJjgC"}
{"name":"VitalBeacon","type":"script","author":"gN2IS1aOvb93eNAA","img":"systems/pf2e/icons/spells/heal-companion.webp","scope":"global","command":"//Macro to automate both Vital Beacon's healing, and\n///decrement the die size.\n//copy this macro and redo it with targeting in order\n/// to make a \"get healing from buddy's vital beacon\" macro\n\nmain()\n\nasync function main(){\n\t//Verify that exacly one token is selected (the caster)\n\tif(canvas.tokens.controlled.length == 0 || canvas.tokens.controlled.length > 1){\n\t\tui.notifications.error(\"Please select exactly one token.\");\n\t\treturn;\n\t}\n\t\n\t//the meat and potatoes: get relevant data, make a roll,\n\t///output that roll to the chat.\n\tlet actor = canvas.tokens.controlled[0].actor;\n\tlet die = actor.data.data.custom.modifiers.vitalBeaconDie;\n\t//short circuits macro if vital beacon has been exhausted\n\tif (parseInt(die) == 0){\n\t\tChatMessage.create({\n\t\t\tuser: game.user._id,\n\t\t\tspeaker: ChatMessage.getSpeaker({token: actor, alias:\"System\"}),\n\t\t\tcontent: `Vital Beacon has been fully expended.`\n\t\t});\n\t\treturn;\n\t}\n\tif(actor.data.items.find(item => item.data.name.includes(\"Vital Beacon (d\")) == undefined){\n\t\tui.notifications.error(\"Vital Beacon is not active on this character.\");\n\t\treturn;\n\t}\n\tlet level = actor.data.data.custom.modifiers.vitalBeaconLevel;\n\tlet test = level + \"d\" + die;\n\tlet roll = new Roll(level + \"d\" + die);\n\troll.toMessage({ flavor: \"Vital Beacon Healing:\", speaker: ChatMessage.getSpeaker({actor: actor})});\n\n\t//decrements the die size of the next Vital Beacon, or\n\t///zeros it out after d4 (informing the user).\n\tconsole.log(die);\n\tif(parseInt(die) < 5){\n\t\tconsole.log(\"Effect over? Vital Beacon equals very no? That's not a good prize!\");\n\t\tChatMessage.create({\n\t\t\tuser: game.user._id,\n\t\t\tspeaker: ChatMessage.getSpeaker({token: actor, alias:\"System\"}),\n\t\t\tcontent: `This is Vital Beacon's last charge.`\n\t\t});\n\t\t//delete old effect and add a Vital Beacon Exhausted effect\n\t\t//actor.update({\"data.custom.modifiers.vitalBeaconDie\": 0});\n\t\tlet oldEffect = actor.data.items.find(item => item.data.name.includes(\"Vital Beacon (d\"));\n\t\tlet d0 = await fromUuid('Item.VbG8Zqk7oGEvzCba');\n\t\td0 = [duplicate(d0)];\n\t\tawait actor.createEmbeddedDocuments('Item',d0);\n\t\toldEffect.delete();\n\t} else {\n\t\t//decrement by 2\n\t\t//actor.update({\"data.custom.modifiers.vitalBeaconLevel\": die - 2});\n\t\tlet oldEffect = actor.data.items.find(item => item.data.name.includes(\"Vital Beacon (d\"));\n\t\tif(oldEffect.data.name.endsWith(\"(d10)\")){\n\t\t\t//create a d8 effect\n\t\t    let d8 = await fromUuid('Item.TDgzNFsxsXJvd2hC');\n\t\t\td8 = [duplicate(d8)];\n\t\t\tawait actor.createEmbeddedDocuments('Item',d8);\n\t\t} else if(oldEffect.data.name.endsWith(\"(d8)\")){\n\t\t\t//create a d6 effect\n\t\t\tlet d6 = await fromUuid('Item.skJBWmVNJg3ug7Vc');\n\t\t\td6 = [duplicate(d6)];\n\t\t\tawait actor.createEmbeddedDocuments('Item',d6);\n\t\t} else if(oldEffect.data.name.endsWith(\"(d6)\")){\n\t\t\t//create a d4 effect\n\t\t\tlet d4 = await fromUuid('Item.DL6nQNZX7oUthLaa');\n\t\t\td4 = [duplicate(d4)];\n\t\t\tawait actor.createEmbeddedDocuments('Item',d4);\n\t\t}\n\t\toldEffect.delete();\n\t}\n}","folder":null,"sort":0,"permission":{"default":0,"gN2IS1aOvb93eNAA":3},"flags":{"core":{"sourceId":"Macro.d5cE8rrjGio3XaFc"}},"_id":"ySQETkchlbdhe03N"}
